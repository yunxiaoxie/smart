"use strict";function FormDirectiveFactory(){return["$log",function(t){return{restrict:"EA",scope:!0,replace:!0,templateUrl:function(e,r){var o=e[0].localName;return o&&o.indexOf("select")!==-1?"html/qk-select.html":o&&o.indexOf("radio")!==-1?"html/qk-radio.html":o&&o.indexOf("checkbox")!==-1?"html/qk-checkbox.html":o&&o.indexOf("date")!==-1?"html/qk-date-picker.html":(t.error("Not supported type:",o),"")},controllerAs:"vm",bindToController:{required:"=",model:"="},controller:["$scope","$element","$attrs","$log","UtilsService",function(t,e,r,o,n){this.getData=function(){r.code&&(console.log(n,r.code),n.querySync("http://127.0.0.1:3000/getDataByCode",{code:r.code}).then(function(e){o.info("code:",r.code),t.data=e},function(){o("Not supported code:",r.code)}))},this.test={},this.format="yyyy-MM-dd",this.popup={opened:!1},this.open=function(){this.popup.opened=!0},this.disabled=function(t,e){return"day"===e&&(0===t.getDay()||6===t.getDay())}}]}}]}angular.module("iRestApp",["ngMessages","ui.bootstrap","iRestApp.basicServer"]),angular.module("iRestApp.basicServer",[]).controller("FormCtrl",["$scope","$filter","$http","UtilsService",function(t,e,r,o){var n=e("date");t.submitted=!1,t.isShow=function(e){return t.submitted||e.$dirty},t.submit=function(){t.submitted=!0,console.log(n(t.formData.birthday,"yyyy-MM-dd")),r.post("http://127.0.0.1:3000/formSave",t.formData).success(function(t){alert(JSON.stringify(t))}).error(function(t){alert("failure message:"+JSON.stringify({data:t}))})}}]).directive("qkSelect",FormDirectiveFactory()).directive("qkRadio",FormDirectiveFactory()).directive("qkCheckbox",FormDirectiveFactory()).directive("qkDatePicker",FormDirectiveFactory()).directive("timeDuration",function(){var t="<div class='input-inline'>             <input class='form-control' type='text' ng-model='num' />             <select class='form-control' ng-model='unit'>                 <option value='seconds'>Seconds</option>                 <option value='minutes'>Minutes</option>                 <option value='hours'>Hours</option>                 <option value='days'>Days</option>             </select>            </div>";return{restrict:"E",template:t,require:"ngModel",replace:!0,link:function(t,e,r,o){var n={seconds:1,minutes:60,hours:3600,days:86400},i=["seconds","minutes","hours","days"];o.$formatters.push(function(t){var e,r,o="minutes",c=0;for(t=parseInt(t||0),e=i.length-1;e>=0;e--)if(r=i[e],t%n[r]===0){o=r;break}return t&&(c=t/n[o]),{unit:o,num:c}}),o.$parsers.push(function(t){var e,r=t.unit,o=t.num;return e=n[r],o*e}),t.$watch("unit + num",function(){o.$setViewValue({unit:t.unit,num:t.num})}),o.$render=function(){o.$viewValue||(o.$viewValue={unit:"hours",num:1}),t.unit=o.$viewValue.unit,t.num=o.$viewValue.num}}}}).directive("chaValid",["$timeout",function(t){return{require:"ngModel",link:function(e,r,o,n){var i;e.$watch(o.ngModel,function(e){return e?(t.cancel(i),void(i=t(function(){var t,r=/[`~!@#$%^&*()+<>?:"{},.\/;\='[\]]/im;return t=!r.test(e),n.$setValidity("chaValid",t),t?e:void 0},300))):void n.$setValidity("chaValid",!0)})}}}]).directive("qkModel",["$compile",function(t){var e="qk-model";return{restrict:"A",terminal:!0,priority:1e5,controller:["$scope","$element","$attrs","$parse",function(t,r,o,n){this.getData=function(){return o.hassubscope&&"true"===o.hassubscope?(console.log(n(r.attr(e))(t)),"$parent."+n(r.attr(e))(t)):n(r.attr(e))(t)}}],link:function(r,o,n,i){var c=i.getData(),u=c?c:o.attr(e);o.removeAttr(e),o.attr("ng-model",u),t(o)(r)}}}]).factory("UtilsService",["$http","$q",function(t,e){return{query:function(e,r,o){return o?o:o="post",t({method:o,url:e,data:r,cache:!1,ignoreLoadingBar:!1})},querySync:function(r,o,n){n?n:n="post";var i=e.defer();return t({method:n,url:r,data:o,cache:!1,ignoreLoadingBar:!1}).success(function(t,e,r,o){i.resolve(t)}).error(function(t,e,r,o){i.reject(t)}),i.promise}}}]);